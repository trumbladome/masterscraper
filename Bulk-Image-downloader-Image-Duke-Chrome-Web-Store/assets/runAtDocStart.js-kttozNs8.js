async function _(){const c="CMD_FROM_PAGE_TO_BG",i="CMD_SILENT_DOWNLOAD";function r(t){chrome.runtime.sendMessage(t)}function s(){let t=[];document.querySelectorAll("img").forEach((a,d)=>{t.push({src:a.src||a.currentSrc,alt:a.alt||"",indexInPage:d})});let e=document.getElementsByTagName("input");for(let a=0;a<e.length;a++){let d=e[a];if(d.type.toUpperCase()==="IMAGE"){let o=d.src;t.push({src:o,indexInPage:t.length})}}let n=document.getElementsByTagName("a");for(let a=0;a<n.length;a++){let o=n[a].href;o.match(/\.(jpg|jpeg|bmp|ico|gif|png)\b/)&&t.push({src:o,indexInPage:t.length})}return t}window.addEventListener("message",t=>{const e=Object.assign({},t.data);if(e.extId==="myOwnCustomeId_sdfse#R@FSFEWFEWs232fs")switch(e.cmd){case"ADD_IMG":case"ADD_VIDEO":case"SET_GROUPS":case"ADD_IMG_LIST":r(e);return;case i:e.cmd=c,e.data={cmd:i,data:e.imgs};break;case"NET":chrome.runtime.sendMessage(e,n=>{window.postMessage({cmd:"CMD_FROM_CT_FETCH_RETURN",from:"ct",cb:e.cb,data:n,index:e.index},"*")});return;case"AIPARSER_GET_NO_IMAGES":r({cmd:"ADD_IMG_LIST",list:s()});return}switch(e.cmd){case c:chrome.runtime.sendMessage(e.data,n=>{window.postMessage({from:"ct",cb:e.cb,data:n})});break;case"CMD_GET_EXT_INFO":window.postMessage({from:"ct",cb:e.cb,data:{id:chrome.runtime.id,version:chrome.runtime.getManifest().version}})}})}function m(){let c={};function i(s,t){let e=`${s.cmd}-${Math.random()}`;s.cb=e,t&&(c[e]=t),window.postMessage(s)}window.addEventListener("message",s=>{s.data.from==="ct"&&c[s.data.cb]&&c[s.data.cb](s.data.data)}),Object.assign(window,{ftk_postMessage:i});const r=s=>{i({cmd:"CMD_FROM_PAGE_TO_BG",data:{cmd:"CMD_GET_SCRIPT"}},t=>{t=="isolated world ai script injected"&&window.addEventListener("message",e=>{switch(e.data.cmd){case"CMD_FROM_CT_COLLECT_IMGS":let n=window.aiparser;n&&n()===-1&&window.postMessage({cmd:"AIPARSER_GET_NO_IMAGES",extId:s.id});break;case"CMD_FROM_CT_FETCH_RETURN":break;case"CMD_EXECUTE_EXTRA":let a=window.extras;a&&a[e.data.data]&&a[e.data.data]();break}})})};i({cmd:"CMD_GET_EXT_INFO"},s=>{r(s)})}async function E(){await _(),m()}E();
