import"./modulepreload-polyfill-B5Qt9EMX.js";import{b as l}from"./browser-polyfill-Bo2e-ahS.js";import{n as c,d as m}from"./iframeResizer.contentWindow-BYR6LlzI.js";import{a as d}from"./init-CM239Bla.js";let i,r,a,s;async function p(){const n=await l.tabs.getCurrent(),e="iframe_"+n.id;i=l.tabs.connect(n.id,{name:e}),i.onMessage.addListener(t=>{switch(t.method){case"showImg":a=Array.isArray(t.imgSrc)?t.imgSrc[0]:t.imgSrc,s=t.imgCaption,r=t.senderTabInfo,u(a);break;case"downloadThisImage":g();break}})}function f(){const e=new URL(a).pathname.split("/").pop(),t=e.split(".").pop().split("?")[0];let o="";return s?o=s.replace(/[^\w\s]/gi,"_").trim():o=e.replace(/\.[^/.]+$/,""),`${o}.${t}`}async function g(){let n=r.url?new URL(r.url).hostname:d;n=[n.replace(/[\\\\/:*?"<>|]/g,"_")];const e=f();n.push(e),await c({url:a,filename:n.join("/"),conflictAction:"uniquify",saveAs:!1}),m(i)}const u=function(n){let e=document.getElementById("imgFixForLong");e.src=n,e.onload=function(){document.getElementById("loading").style.visibility="hidden",i.postMessage({cmd:"imgShowed",dimention:{w:e.naturalWidth,h:e.naturalHeight}})}},w=async function(){await p()};w();
